import{r as i,y as j,H as E,c as I,d as D,j as t,w as p,e as u,h as P,F as z,s as O,C as w,o as G}from"./index-Wf_wPvl6.js";import{U as m}from"./UserService-XJjYQyDy.js";import{A as H,_ as y,a as Z}from"./DataPicker-X0WrNYVz.js";import{F as J,I as s,B as K}from"./ButtonSubmit-k6eKklm4.js";import{_ as Q,u as W}from"./Modal-VcVCPYWW.js";const X={class:"flex flex-col w-full my-5"},Y={class:"flex flex-col gap-5 md:flex-row"},ee={class:"flex flex-col gap-5 mt-5 md:flex-row"},le={class:"flex flex-col gap-5 mt-5 md:flex-row"},ae={class:"flex flex-col gap-5 mt-5 md:flex-row"},oe={class:"flex flex-col md:flex-row md:items-end gap-3 lg:w-2/4"},te={class:"flex flex-col gap-5 mt-5 md:flex-row"},de={class:"flex flex-col gap-5 mt-5 md:flex-row md:mt-5"},se=u("p",{class:"flex"},"Deseja prosseguir com a alteração dos dados?",-1),S={__name:"ShowUserForm",props:{myuser:Object},setup(V){const c=V,n=i(!1),r=i([]),v=i([]),x=i([]),f=i(null),d=i({id:"",name:"",email:"",internalcode:"",role:null}),a=i({user_id:"",avatar:"",class:"",nif:"",gender_id:"",phone_number:"",birthday_date:"",address:"",city:"",district:"",postal_code:"",country_id:""});j(()=>c.myuser,e=>{var l,o,g,T,h,C,L,U,q,F,A,B;if(e){let $=Array.isArray(e.roles)&&e.roles.length>0?e.roles[0]:{};d.value={id:e.id||"",name:e.name||"",email:e.email||"",internalcode:e.internalcode||"",role:$.id||""},a.value={user_id:((l=e.user_info)==null?void 0:l.user_id)||"",avatar:((o=e.user_info)==null?void 0:o.profile_picture_path)||"",class:((g=e.user_info)==null?void 0:g.class)||"",nif:(T=e.user_info)!=null&&T.nif?e.user_info.nif.toString():"",gender_id:(h=e.user_info)!=null&&h.gender_id?e.user_info.gender_id:"",phone_number:(C=e.user_info)!=null&&C.phone_number?e.user_info.phone_number.toString():"",birthday_date:((L=e.user_info)==null?void 0:L.birthday_date)||"",address:((U=e.user_info)==null?void 0:U.address)||"",city:((q=e.user_info)==null?void 0:q.city)||"",district:((F=e.user_info)==null?void 0:F.district)||"",postal_code:((A=e.user_info)==null?void 0:A.postal_code)||"",country_id:(B=e.user_info)!=null&&B.country_id?e.user_info.country_id:""}}},{deep:!0,immediate:!0}),E(async()=>{try{r.value=(await m.getRoles()).data,v.value=(await m.getGenders()).data,x.value=(await m.getCountries()).data}catch(e){console.error("Error:",e.response)}});const k=e=>{f.value=e,a.value.avatar=URL.createObjectURL(e)},_=e=>{const l=Object.keys(e)[0];a[l]=e[l]},b=()=>{n.value=!0},M=async()=>{R()},N=()=>{n.value=!1},R=async()=>{const e=new FormData;f.value&&e.append("file",f.value),e.append("user_id",a.value.user_id),e.append("name",d.value.name),e.append("class",a.value.class),e.append("nif",a.value.nif),e.append("birthday_date",a.value.birthday_date),e.append("gender_id",a.value.gender_id),e.append("phone_number",a.value.phone_number),e.append("address",a.value.address),e.append("postal_code",a.value.postal_code),e.append("city",a.value.city),e.append("district",a.value.district),e.append("country_id",a.value.country_id),e.append("_method","PUT");try{await m.updateUser(d.value),console.log("User updated successfully"),await m.updateUserInfo(e).then(l=>{l.success&&(n.value=!1,O.push({name:"Users"}),W().triggerToast("Utilizador actualizado com sucesso!","success"))})}catch(l){console.error("Error: ",l.response)}};return(e,l)=>(I(),D(z,null,[t(S,{onFormSubmit:b},{AvatarCard:p(()=>[t(H,{onAvatar:k,modelValue:a.value.avatar,"onUpdate:modelValue":l[0]||(l[0]=o=>a.value.avatar=o)},null,8,["modelValue"])]),Form:p(()=>[t(J,{FormTitle:"Update User"}),u("div",X,[u("div",Y,[t(s,{LabelTitle:"Full Name",type:"name",required:"",modelValue:d.value.name,"onUpdate:modelValue":l[1]||(l[1]=o=>d.value.name=o)},null,8,["modelValue"]),t(s,{LabelTitle:"Email",type:"email",required:"",modelValue:d.value.email,"onUpdate:modelValue":l[2]||(l[2]=o=>d.value.email=o)},null,8,["modelValue"])]),u("div",ee,[t(s,{LabelTitle:"Internal Code",type:"text",required:"",modelValue:d.value.internalcode,"onUpdate:modelValue":l[3]||(l[3]=o=>d.value.internalcode=o)},null,8,["modelValue"]),t(s,{LabelTitle:"Class",type:"text",required:"",modelValue:a.value.class,"onUpdate:modelValue":l[4]||(l[4]=o=>a.value.class=o)},null,8,["modelValue"])]),u("div",le,[t(y,{LabelTitle:"Role",options:r.value,modelValue:d.value.role,"onUpdate:modelValue":[l[5]||(l[5]=o=>d.value.role=o),_]},null,8,["options","modelValue"]),t(y,{LabelTitle:"Gender",options:v.value,modelValue:a.value.gender_id,"onUpdate:modelValue":[l[6]||(l[6]=o=>a.value.gender_id=o),_]},null,8,["options","modelValue"]),t(Z,{LabelTitle:"Birthday Date",required:"",modelValue:a.value.birthday_date,"onUpdate:modelValue":l[7]||(l[7]=o=>a.value.birthday_date=o)},null,8,["modelValue"])]),u("div",ae,[u("div",oe,[t(s,{LabelTitle:"NIF",type:"text",required:"",modelValue:a.value.nif,"onUpdate:modelValue":l[8]||(l[8]=o=>a.value.nif=o)},null,8,["modelValue"])]),t(s,{LabelTitle:"Phone Number",type:"text",required:"",modelValue:a.value.phone_number,"onUpdate:modelValue":l[9]||(l[9]=o=>a.value.phone_number=o)},null,8,["modelValue"])]),u("div",te,[t(s,{LabelTitle:"Address",type:"address",required:"",modelValue:a.value.address,"onUpdate:modelValue":l[10]||(l[10]=o=>a.value.address=o)},null,8,["modelValue"]),t(s,{LabelTitle:"Zip Code",type:"text",required:"",modelValue:a.value.postal_code,"onUpdate:modelValue":l[11]||(l[11]=o=>a.value.postal_code=o)},null,8,["modelValue"])]),u("div",de,[t(s,{LabelTitle:"State/Province",type:"text",required:"",modelValue:a.value.district,"onUpdate:modelValue":l[12]||(l[12]=o=>a.value.district=o)},null,8,["modelValue"]),t(s,{LabelTitle:"City",type:"text",required:"",modelValue:a.value.city,"onUpdate:modelValue":l[13]||(l[13]=o=>a.value.city=o)},null,8,["modelValue"]),t(y,{LabelTitle:"Country",options:x.value,modelValue:a.value.country_id,"onUpdate:modelValue":[l[14]||(l[14]=o=>a.value.country_id=o),_]},null,8,["options","modelValue"])])]),t(K,{onClick:l[15]||(l[15]=o=>b(d.value)),textButton:"Update User"})]),_:1}),t(Q,{show:n.value,onCancel:N,onConfirm:M},{title:p(()=>[P(" Alterar dados de utilizador ")]),content:p(()=>[se]),_:1},8,["show"])],64))}},re={class:"flex flex-col w-full xl:items-center"},ce={__name:"UserDetailsPage",setup(V){const c=w(),n=i({});return G(async()=>{try{const r=await m.getUser(c.params.userId);r.success?(n.value=r.data,console.log("User Data:",n)):console.error("Invalid response structure:",r)}catch(r){console.error("Error fetching tickets:",r)}}),(r,v)=>(I(),D("div",re,[t(S,{myuser:n.value},null,8,["myuser"])]))}};export{ce as default};
