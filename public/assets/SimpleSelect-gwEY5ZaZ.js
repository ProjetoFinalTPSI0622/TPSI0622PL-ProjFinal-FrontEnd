import{s as T,r as y,o as S,e as n,f as l,g as v,t as g,F as h,i as V,h as b,k as p,q as M,u as m}from"./index-Gnznze0_.js";import{u as t}from"./Modal-n158dQhz.js";import{T as i}from"./SideSectionTop-g-usTibD.js";import{u as E}from"./UserStore-7eJIVK_9.js";const I=T({id:"modal",state:()=>({showModal:!1,newValue:null,ticketID:null,oldValue:0,type:""}),actions:{handleShowModalStatus(e,s,a){this.showModal=!0,this.ticketID=s,this.oldValue=a,this.newValue=e,this.type="status"},handleShowModalTech(e,s,a){this.showModal=!0,this.ticketID=s,this.oldValue=a,this.newValue=e,this.type="technician"},handleCancelModal(){this.showModal=!1},async handleConfirmModal(){switch(this.type){case"status":await this.changeStatus();break;case"technician":await this.assignTechnician();break}this.showModal=!1},async changeStatus(){(await i.updateStatus(this.ticketID,this.newValue)).success?t().triggerToast("O status do ticket foi alterado !","success"):t().triggerToast("Erro ao alterar o status do ticket !","error")},async assignTechnician(){(await i.assignTechnician(this.ticketID,this.newValue)).success?(t().triggerToast("O técnico foi assignado ao ticket !","success"),(await i.updateStatus(this.ticketID,2)).success?t().triggerToast(' status do tiOcket foi alterado para "Em Progresso"!',"success"):t().triggerToast('Erro ao alterar o status do ticket para "Em Progresso"!',"error")):t().triggerToast("Erro ao assignar o técnico ao ticket !","error")},async closeTicket(e){(await i.closeTicket(e)).success?t().triggerToast("O ticket foi fechado !","success"):t().triggerToast("Erro ao fechar o ticket !","error")},async reopenTicket(e){(await i.reopenTicket(e)).success?(t().triggerToast("O ticket foi reaberto!","success"),(await i.assignTechnician(e,null)).success?t().triggerToast("O técnico foi removido do ticket !","success"):t().triggerToast("Erro ao remover o técnico do ticket !","error")):t().triggerToast("Erro ao reabrir o ticket !","error")},convertTicketsToPDF(e){let s=document.createElement("div");e.forEach(r=>{s.innerHTML+=`
                    <div style="border: 1px solid black; margin: 10px; padding: 10px;">
                        <p>${r.createdby.email}</p>
                        <p>${r.title}</p>
                        <p>${r.status.status_name}</p>
                    </div>
                `});let a={margin:1,filename:"FilteredTickets.pdf",image:{type:"jpeg",quality:.98},html2canvas:{scale:2},jsPDF:{unit:"in",format:"letter",orientation:"portrait"}};html2pdf().set(a).from(s).save()}}}),L="data:image/svg+xml,%3c!DOCTYPE%20svg%20PUBLIC%20'-//W3C//DTD%20SVG%201.1//EN'%20'http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd'%3e%3c!--%20Uploaded%20to:%20SVG%20Repo,%20www.svgrepo.com,%20Transformed%20by:%20SVG%20Repo%20Mixer%20Tools%20--%3e%3csvg%20fill='%23ffffff'%20width='19'%20height='19'%20viewBox='-3.5%200%2019%2019'%20xmlns='http://www.w3.org/2000/svg'%20class='cf-icon-svg'%3e%3cg%20id='SVGRepo_bgCarrier'%20stroke-width='0'/%3e%3cg%20id='SVGRepo_tracerCarrier'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3cg%20id='SVGRepo_iconCarrier'%3e%3cpath%20d='M11.383%2013.644A1.03%201.03%200%200%201%209.928%2015.1L6%2011.172%202.072%2015.1a1.03%201.03%200%201%201-1.455-1.456l3.928-3.928L.617%205.79a1.03%201.03%200%201%201%201.455-1.456L6%208.261l3.928-3.928a1.03%201.03%200%200%201%201.455%201.456L7.455%209.716z'/%3e%3c/g%3e%3c/svg%3e",x=["disabled"],D={selected:""},C=["value"],A={__name:"SimpleSelect",props:{currentValue:Object,newValues:Array},emits:["show-modal"],setup(e,{emit:s}){const a=E(),r=y(null);let d=0;S(async()=>{await a.fetchAuthedUser()});const f=s,w=u=>{f("show-modal",u,d)},k=()=>{d=r.value.selectedIndex};return(u,c)=>(n(),l("select",{ref_key:"selectbox",ref:r,onChange:c[0]||(c[0]=p(o=>w(o.target.value),["prevent"])),onClick:c[1]||(c[1]=p(()=>{},["stop"])),onMousedown:k,style:M({appearance:m(a).userRole!=="admin"?"none":"auto"}),class:"border bg-white w-full py-1 lg:py-2 lg:px-2.5 rounded-lg border-solid border-black border-opacity-20",disabled:m(a).userRole!=="admin"},[v("option",D,g(e.currentValue?e.currentValue.name:"Sem Técnico"),1),(n(!0),l(h,null,V(e.newValues,o=>(n(),l(h,null,[o&&(!e.currentValue||o.name!==e.currentValue.name)?(n(),l("option",{key:o.id,value:o.id},g(o.name),9,C)):b("",!0)],64))),256))],44,x))}};export{L as _,A as a,I as u};
