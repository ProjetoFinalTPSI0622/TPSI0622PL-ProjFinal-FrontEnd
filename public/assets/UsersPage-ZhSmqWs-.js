import{U}from"./UserService-XJjYQyDy.js";import{S as j}from"./SimpleButton-nEiu8VTy.js";import{_ as D}from"./SearchBox-Je5hRELG.js";import{c as i,d as _,e,j as h,w as g,h as v,u as E,R as S,F as w,_ as $,r as f,t as m,m as k,p as C,q as I,f as M,g as A,s as L,x as T,o as P,y as N,z}from"./index-Wf_wPvl6.js";import{_ as B,u as O}from"./Modal-VcVCPYWW.js";const R={class:"text-purple flex sm:text-2xl text-xl whitespace-nowrap justify-between p-4 border-b-purple border-b-opacity-30 border-b border-solid items-start"},F=e("div",null,"All Users",-1),V={class:"flex flex-row justify-between p-3 border-b-black border-b-opacity-30 border-b border-solid items-start"},q=e("span",{class:"justify-center bg-purple flex gap-2.5 px-3 sm:px-6 py-[5.5px] rounded-xl"},[e("div",{class:"text-white sm:text-xl"},"Filter"),e("img",{loading:"lazy",src:"https://cdn.builder.io/api/v1/image/assets/TEMP/0510fad93eca8f0eb44f11602487e1815b688bf1e81320ed0afe33b8cdcc0f34?apiKey=a9b902b8934746c7aacbbad131e88c89&",class:"w-6 sm:aspect-[1.04] object-contain object-center"})],-1),G={class:""},H={__name:"TopMenu",props:{searchTerm:String},emits:["update:searchTerm"],setup(s,{emit:a}){const o=s,r=a;return(t,l)=>(i(),_(w,null,[e("span",R,[F,h(E(S),{to:"/users/create"},{default:g(()=>[h(j,null,{default:g(()=>[v(" + Add User ")]),_:1})]),_:1})]),e("div",V,[q,e("div",G,[h(D,{searchTerm:o.searchTerm,"onUpdate:searchTerm":l[0]||(l[0]=u=>r("update:searchTerm",u))},null,8,["searchTerm"])])])],64))}},y=s=>(C("data-v-2d3e6882"),s=s(),I(),s),K={class:"hoverGrey border-b-black border-b-opacity-30 border-b border-solid"},J={class:"flex flex-col md:flex-row gap-2.5"},Q=["src"],W={class:"flex"},X={class:"text-black text-opacity-80 text-sm sm:text-lg self-center"},Y={class:"flex"},Z={class:"font-bold"},ee=y(()=>e("br",null,null,-1)),se=y(()=>e("p",{class:"font-bold text-red-600"},"ATENÇÃO!!!",-1)),te=y(()=>e("p",{class:"text-red-600"},"Esta acção não pode ser revertida!",-1)),re={__name:"UserItem",props:{user:Object},emits:["userDeleted"],setup(s,{emit:a}){const o=a,r=f(!1),t=f(null),l=c=>{t.value=c,r.value=!0},u=async()=>{if(event.stopPropagation(),t.value){const c=await U.deleteUser(t.value.id);c.success?(O().triggerToast(`Utilizador ${t.value.name}, apagado com sucesso!`,"success"),o("userDeleted")):console.error("Error deleting user:",c.message)}r.value=!1},p=()=>{r.value=!1,event.stopPropagation()};return(c,n)=>(i(),_("tr",K,[e("td",J,[e("img",{loading:"lazy",src:s.user.user_info.profile_picture_path,class:"aspect-square object-contain object-center w-10 overflow-hidden shrink-0 max-w-full rounded-[50%]"},null,8,Q),e("span",W,[e("div",X,m(s.user.name),1)])]),e("td",null,m(s.user.email),1),e("td",null,m(s.user.user_info.class),1),e("td",null,m(s.user.internalcode),1),e("td",null,[e("button",{onClick:n[0]||(n[0]=k(b=>l(s.user),["stop"])),class:"px-4 py-2 ml-2 bg-red-500 text-white rounded hover:bg-red-700 transition duration-300"}," Apagar ")]),h(B,{show:r.value,onCancel:p,onConfirm:u},{title:g(()=>[v(" Apagar utilizador ")]),content:g(()=>[e("p",Y,[v("Esta prestes a apagar  "),e("div",Z,m(s.user.name),1),v(", pretende prosseguir?")]),ee,se,te]),_:1},8,["show"])]))}},ae=$(re,[["__scopeId","data-v-2d3e6882"]]),oe=s=>(C("data-v-9524e88b"),s=s(),I(),s),le=oe(()=>e("thead",null,[e("tr",{class:"border-b-black border-b-opacity-30 border-b border-solid"},[e("th",null,"NOME"),e("th",null,"EMAIL"),e("th",null,"TURMA"),e("th",null,"CÓDIGO INTERNO"),e("th",null,"ACÇÕES")])],-1)),ne={__name:"UsersTable",props:{users:Array},emits:["userDeleted"],setup(s,{emit:a}){const o=a,r=l=>{L.push({name:"userDetails",params:{userId:l}})},t=()=>{o("userDeleted")};return(l,u)=>(i(),_("table",null,[le,e("tbody",null,[(i(!0),_(w,null,M(s.users,p=>(i(),A(ae,{onClick:k(c=>r(p.id),["stop"]),key:p.id,user:p,onUserDeleted:t},null,8,["onClick","user"]))),128))])]))}},ce=$(ne,[["__scopeId","data-v-9524e88b"]]),de={class:"flex w-full"},ie={class:"flex flex-col w-full"},ue={class:"flex justify-between px-5 py-2 border-b-black border-b-opacity-30 border-b border-solid"},pe={class:"text-black text-opacity-60 sm:text-xl"},me={class:"flex sm:gap-2.5"},_e=["onClick"],ge={__name:"UsersPage",setup(s){const a=f([]),o=f(1),r=f(5),t=f(""),l=T(()=>{const n=a.value.filter(x=>x.name.toLowerCase().includes(t.value.toLowerCase())||x.email.toLowerCase().includes(t.value.toLowerCase())||x.internalcode.toLowerCase().includes(t.value.toLowerCase())),b=(o.value-1)*r.value,d=b+r.value;return n.slice(b,d)}),u=async()=>{try{a.value=(await U.getUsers()).data}catch(n){console.error("Erro ao procurar usuários:",n)}};P(async()=>{await u()});const p=T(()=>Math.ceil(a.value.length/r.value)),c=n=>{o.value=n};return N(t,()=>{o.value=1}),(n,b)=>(i(),_("div",de,[e("span",ie,[h(H,{searchTerm:t.value,"onUpdate:searchTerm":b[0]||(b[0]=d=>t.value=d)},null,8,["searchTerm"]),e("span",ue,[e("div",pe,m(a.value.length)+" Users",1),e("div",me,[(i(!0),_(w,null,M(p.value,d=>(i(),_("span",{class:z(["text-black sm:text-xl justify-center px-1.5 py-0.5 rounded-md self-start cursor-pointer",{"bg-purple text-white":d===o.value,"aspect-[0.8148148148148148]":!0}]),key:d,onClick:x=>c(d)},m(d),11,_e))),128))])]),h(ce,{users:l.value,onUserDeleted:u},null,8,["users"])])]))}};export{ge as default};
