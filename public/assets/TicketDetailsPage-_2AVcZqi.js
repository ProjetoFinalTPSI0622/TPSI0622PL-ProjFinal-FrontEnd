import{c as n,d,e,t as c,A as f,_ as N,C as A,r as m,o as U,a as P,y as Z,j as l,w as u,F as S,f as T,n as j,v as q,B as Y,m as L,u as x,k as O,h,p as W,q as F,D as z}from"./index-Wf_wPvl6.js";import{u as J,a as K,_ as Q,b as X}from"./TicketStore-k3kumc8v.js";import{_ as ee,a as te,b as se,c as oe}from"./attach-lmn-EXm-.js";import{T as re,_ as ae,S as ce}from"./SideSectionTop-AUwRLSmN.js";import{U as ie}from"./UserService-XJjYQyDy.js";import{S as D}from"./SimpleButton-nEiu8VTy.js";import{_ as le}from"./Modal-VcVCPYWW.js";const ne="data:image/svg+xml,%3c!DOCTYPE%20svg%20PUBLIC%20'-//W3C//DTD%20SVG%201.1//EN'%20'http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd'%3e%3c!--%20Uploaded%20to:%20SVG%20Repo,%20www.svgrepo.com,%20Transformed%20by:%20SVG%20Repo%20Mixer%20Tools%20--%3e%3csvg%20width='24'%20height='24'%20viewBox='0%200%20512%20512'%20xmlns='http://www.w3.org/2000/svg'%20fill='%23000000'%3e%3cg%20id='SVGRepo_bgCarrier'%20stroke-width='0'/%3e%3cg%20id='SVGRepo_tracerCarrier'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3cg%20id='SVGRepo_iconCarrier'%3e%3cpath%20fill='var(--ci-primary-color,%20%23000000)'%20d='M334.627,16H48V496H472V153.373ZM440,166.627V168H320V48h1.373ZM80,464V48H288V200H440V464Z'%20class='ci-primary'/%3e%3crect%20width='224'%20height='32'%20x='136'%20y='296'%20fill='var(--ci-primary-color,%20%23000000)'%20class='ci-primary'/%3e%3crect%20width='224'%20height='32'%20x='136'%20y='376'%20fill='var(--ci-primary-color,%20%23000000)'%20class='ci-primary'/%3e%3c/g%3e%3c/svg%3e",de={class:"flex gap-4"},pe={class:"flex flex-col text-lg gap-4 text-wrap"},me=e("div",{class:"flex gap-1"},[e("img",{src:ne}),e("p",{class:"text-2xl"}," Ticket Description ")],-1),ue={class:"text-black text-opacity-70"},ge={__name:"DescriptionView",props:{description:String},setup(o){return(v,s)=>(n(),d("div",de,[e("div",pe,[me,e("p",ue,c(o.description),1)])]))}},he={class:"flex gap-4"},_e={class:"text-lg flex flex-col gap-2 text-wrap"},fe={class:"text-xl"},xe={class:"text-black text-opacity-65"},ve={__name:"CommentsView",props:{comment:Object},setup(o){return(v,s)=>(n(),d("div",he,[e("div",_e,[e("p",fe,c(o.comment.user.name),1),e("p",xe,c(o.comment.comment_body),1)])]))}},ye="data:image/svg+xml,%3c!DOCTYPE%20svg%20PUBLIC%20'-//W3C//DTD%20SVG%201.1//EN'%20'http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd'%3e%3c!--%20Uploaded%20to:%20SVG%20Repo,%20www.svgrepo.com,%20Transformed%20by:%20SVG%20Repo%20Mixer%20Tools%20--%3e%3csvg%20fill='%23ffffff'%20width='24'%20height='24'%20viewBox='0%200%2024%2024'%20xmlns='http://www.w3.org/2000/svg'%20stroke='none'%3e%3cg%20id='SVGRepo_bgCarrier'%20stroke-width='0'/%3e%3cg%20id='SVGRepo_tracerCarrier'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3cg%20id='SVGRepo_iconCarrier'%3e%3cpath%20d='M3,4V16a1,1,0,0,0,1,1H9l3,4,3-4h5a1,1,0,0,0,1-1V4a1,1,0,0,0-1-1H4A1,1,0,0,0,3,4ZM8,7h8a1,1,0,0,1,0,2H8A1,1,0,0,1,8,7Zm0,5h4a1,1,0,0,1,0,2H8a1,1,0,0,1,0-2Z'/%3e%3c/g%3e%3c/svg%3e",we="data:image/svg+xml,%3c!DOCTYPE%20svg%20PUBLIC%20'-//W3C//DTD%20SVG%201.1//EN'%20'http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd'%3e%3c!--%20Uploaded%20to:%20SVG%20Repo,%20www.svgrepo.com,%20Transformed%20by:%20SVG%20Repo%20Mixer%20Tools%20--%3e%3csvg%20width='24'%20height='24'%20viewBox='0%200%20512%20512'%20xmlns='http://www.w3.org/2000/svg'%20fill='%23fff'%3e%3cg%20id='SVGRepo_bgCarrier'%20stroke-width='0'/%3e%3cg%20id='SVGRepo_tracerCarrier'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3cg%20id='SVGRepo_iconCarrier'%3e%3cpath%20fill='var(--ci-primary-color,%20%23fff)'%20d='M334.627,16H48V496H472V153.373ZM440,166.627V168H320V48h1.373ZM80,464V48H288V200H440V464Z'%20class='ci-primary'/%3e%3crect%20width='224'%20height='32'%20x='136'%20y='296'%20fill='var(--ci-primary-color,%20%23fff)'%20class='ci-primary'/%3e%3crect%20width='224'%20height='32'%20x='136'%20y='376'%20fill='var(--ci-primary-color,%20%23fff)'%20class='ci-primary'/%3e%3c/g%3e%3c/svg%3e",b={getComments:async o=>f.makeRequest("get",`tickets/${o}/comments`),createComment:async o=>f.makeRequest("post","comments",o),deleteComment:async o=>f.makeRequest("delete",`comments/${o}`),getCommentTypes:async()=>f.makeRequest("get","commentTypes")},i=o=>(W("data-v-6a7575be"),o=o(),F(),o),be={class:"flex w-full"},ke={class:"flex flex-col p-2 xl:p-5 gap-4"},Ce={class:"flex flex-col gap-3"},Ve=i(()=>e("label",{class:"text-pink-600 text-l xl:text-lg justify-center"}," Requester ",-1)),Se={class:"border bg-white flex justify-between w-40 lg:w-full py-1 lg:py-2 lg:px-2.5 rounded-lg border-solid border-black border-opacity-20"},Te={class:"flex flex-col gap-3"},je=i(()=>e("label",{class:"text-pink-600 text-l xl:text-lg justify-center"}," Assigned to ",-1)),De={class:"flex justify-between w-40 lg:w-full"},Ge={class:"flex flex-col gap-3"},Me=i(()=>e("label",{class:"text-pink-600 text-l xl:text-lg justify-center"}," Categoria ",-1)),Re={class:"border bg-white flex justify-between w-40 lg:w-full py-1 lg:py-2 lg:px-2.5 rounded-lg border-solid border-black border-opacity-20"},$e={class:"flex flex-col gap-3"},Be=i(()=>e("label",{class:"text-pink-600 text-l xl:text-lg justify-center"}," UrgÃªncia ",-1)),He={class:"border bg-white flex justify-between w-40 lg:w-full py-1 lg:py-2 lg:px-2.5 rounded-lg border-solid border-black border-opacity-20"},Ie={class:"flex flex-col gap-3"},Ee=i(()=>e("label",{class:"text-pink-600 text-l xl:text-lg justify-center"}," Estado ",-1)),Ne={class:"border bg-white flex justify-between w-40 lg:w-full py-1 lg:py-2 lg:px-2.5 rounded-lg border-solid border-black border-opacity-20"},Ae={disabled:"",selected:""},Ue=i(()=>e("img",{class:"self-center",src:Q},null,-1)),Pe={class:"flex flex-col w-full lg:w-[80%]"},Ze={class:"justify-center flex flex-col px-5 h-[12vh] sm:h-[9vh] border-b-black border-b border-solid"},qe={class:"justify-between flex flex-col xl:flex-row gap-2 xl:gap-5"},Ye={class:"text-purple text-2xl"},Le={class:"flex justify-end"},Oe=["src"],We={class:"text-purple flex sm:text-2xl text-xl h-[50vh] justify-between pl-6 pr-12 py-4 border-b-purple border-b-opacity-30 border-b border-solid items-start"},Fe={key:1},ze={class:"text-purple flex flex-col gap-4 sm:text-2xl text-xl h-[30vh] whitespace-nowrap justify-between p-3 items-start"},Je={class:"flex text-xl gap-2"},Ke={class:"flex border-r-2 border-solid border-black border-opacity-30 pr-2"},Qe=i(()=>e("img",{src:ee},null,-1)),Xe=["value"],et=i(()=>e("div",{class:"flex gap-4"},[e("p",null,"To"),e("div",{class:"flex gap-1"},[e("img",{loading:"lazy",src:X,class:"aspect-square object-cover object-center w-8 h-8 rounded-[50%]"}),e("p",null,"MoNengue")])],-1)),tt={class:"w-full"},st={class:"w-full border border-solid border-black border-opacity-20 rounded-lg bg-grey"},ot={class:"px-4 py-2 bg-grey rounded-t-lg"},rt=i(()=>e("label",{for:"comment",class:"sr-only"},"Your comment",-1)),at={class:"flex items-center justify-between px-3 py-2 border-t"},ct=O('<div class="flex ps-0 space-x-1 rtl:space-x-reverse sm:ps-2" data-v-6a7575be><button type="button" class="inline-flex justify-center items-center p-2 text-gray-500 rounded cursor-pointer hover:text-gray-900 hover:bg-gray-100" data-v-6a7575be><img src="'+te+'" data-v-6a7575be></button><button type="button" class="inline-flex justify-center items-center p-2 text-gray-500 rounded cursor-pointer hover:text-gray-900 hover:bg-gray-100" data-v-6a7575be><img src="'+se+'" data-v-6a7575be></button><button type="button" class="inline-flex justify-center items-center p-2 text-gray-500 rounded cursor-pointer hover:text-gray-900 hover:bg-gray-100" data-v-6a7575be><img src="'+oe+'" data-v-6a7575be></button></div>',1),it={__name:"TicketDetailsPage",setup(o){const v=A(),s=m({}),k=m([]),g=J(),y=m(""),C=m(null),_=m(1),w=m([]);U(async()=>{await M(),await G(),await R()});const p=P({showComments:!1}),G=async()=>{try{const t=await ie.getTechnicians();t.success?k.value=t.data:console.error("Invalid response structure:",t)}catch(t){console.error("Error fetching technicians:",t)}},M=async()=>{try{s.value=(await re.getTicket(v.params.ticketId)).data}catch(t){console.error("Error fetching tickets:",t)}},R=async()=>{try{C.value=(await b.getCommentTypes()).data}catch(t){console.error("Error fetching comment types:",t)}},$=async()=>{const t={comment_body:y.value,comment_type:_.value,ticket_id:s.value.id};try{const a=await b.createComment(t)}catch(a){console.error("Error posting comment:",a)}await z(async()=>{await V()})},B=t=>{_.value=t.target.value},V=async()=>{try{w.value=(await b.getComments(s.value.id)).data.comments,console.log(w.value)}catch(t){console.error("Error fetching comments:",t)}};Z(()=>p.showComments,async()=>{p.showComments&&(console.log("fetching comments"),await V())});const H=(t,a,r)=>{g.handleShowModal(t,a,r)},I=()=>{g.handleCancelModal()},E=()=>{g.handleConfirmModal()};return(t,a)=>(n(),d("div",be,[l(ae,{ticket:s.value},{default:u(()=>[l(ce,null,{default:u(()=>[h("Ticket Details")]),_:1}),e("div",ke,[e("div",Ce,[Ve,e("div",Se,c(s.value.createdby?s.value.createdby.name:"N/A"),1)]),e("div",Te,[je,e("div",De,[l(K,{assignedto:s.value.assignedto,technicians:k.value,onShowModal:H},null,8,["assignedto","technicians"])])]),e("div",Ge,[Me,e("div",Re,c(s.value.category?s.value.category.category_name:"N/A"),1)]),e("div",$e,[Be,e("div",He,c(s.value.priority?s.value.priority.priority_name:"N/A"),1)]),e("div",Ie,[Ee,e("select",Ne,[e("option",Ae,c(s.value.status?s.value.status.status_name:"N/A"),1)])]),l(D,{class:"w-full py-1 mt-4"},{default:u(()=>[Ue,h(" Close ticket ")]),_:1})])]),_:1},8,["ticket"]),e("div",Pe,[e("div",Ze,[e("span",qe,[e("div",Ye,c(s.value.title?s.value.title:"N/A"),1),e("div",Le,[l(D,{onClick:a[0]||(a[0]=r=>p.showComments=!p.showComments)},{default:u(()=>[h(c(p.showComments?"Description":"Comments")+" ",1),e("img",{src:p.showComments?x(we):x(ye)},null,8,Oe)]),_:1})])])]),e("div",We,[p.showComments?(n(!0),d(S,{key:0},T(w.value,r=>(n(),d("div",{key:r.id},[l(ve,{comment:r},null,8,["comment"])]))),128)):(n(),d("div",Fe,[l(ge,{description:s.value.description},null,8,["description"])]))]),e("div",ze,[e("div",Je,[e("div",Ke,[Qe,j(e("select",{class:"flex px-2","onUpdate:modelValue":a[1]||(a[1]=r=>_.value=r),onChange:B},[(n(!0),d(S,null,T(C.value,r=>(n(),d("option",{key:r.id,value:r.id},c(r.name),9,Xe))),128))],544),[[q,_.value]])]),et]),e("form",tt,[e("div",st,[e("div",ot,[rt,j(e("textarea",{id:"comment",rows:"4","onUpdate:modelValue":a[2]||(a[2]=r=>y.value=r),onInput:a[3]||(a[3]=(...r)=>t.testeInput&&t.testeInput(...r)),class:"w-full px-0 text-base text-gray-900 bg-grey focus:outline-none focus-visible:outline-none",placeholder:"Write here your comment...",required:""},null,544),[[Y,y.value]])]),e("div",at,[ct,e("button",{type:"submit",onClick:L($,["prevent"]),class:"inline-flex items-center py-2.5 px-4 text-xs font-medium text-center text-white bg-purple rounded-lg hoverBlue"}," Post comment ")])])])])]),l(le,{show:x(g).showModal,onCancel:I,onConfirm:E},{title:u(()=>[h(" Assign Technician ")]),content:u(()=>[h(" You are about to assign "+c(x(g).selectedTechnician)+" to this ticket, are you sure? ",1)]),_:1},8,["show"])]))}},ht=N(it,[["__scopeId","data-v-6a7575be"]]);export{ht as default};
