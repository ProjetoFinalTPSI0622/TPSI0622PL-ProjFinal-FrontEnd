import{S as H,_ as Y,T as Q}from"./SideSectionTop-AUwRLSmN.js";import{U as A}from"./UserService-XJjYQyDy.js";import{c,g as I,w as $,h as j,j as v,e,a as W,d,u as S,R as J,F as y,f as k,m as K,t as g,i as O,n as X,v as Z,_ as N,p as D,q as G,s as ee,r as b,o as te,x as M,y as se,z as le}from"./index-Wf_wPvl6.js";import{_ as oe,u as U,a as ne,b as ae}from"./TicketStore-k3kumc8v.js";import{_ as re}from"./Chevron Down-nkaAdt-3.js";import{S as ie}from"./SimpleButton-nEiu8VTy.js";import{_ as ce}from"./SearchBox-Je5hRELG.js";import{_ as de}from"./Modal-VcVCPYWW.js";const pe={class:"flex flex-col py-2 gap-4"},ue={class:"flex flex-col px-4 gap-2 xl:gap-4"},xe=e("div",{class:"hoverGreyDark rounded-t-lg justify-center py-3.5 px-2 flex flex-col border-b-purple border-b-opacity-30 border-b border-solid"},[e("span",{class:"justify-between flex"},[e("div",{class:"text-purple text-l xl:text-lg whitespace-nowrap pr-2"}," Assignados a mim "),e("span",{class:"text-white text-l xl:text-lg whitespace-nowrap justify-center bg-purple aspect-[1.5] px-2.5 rounded-3xl"},"10")])],-1),he=e("span",{class:"justify-between flex"},[e("div",{class:"text-purple text-l xl:text-lg whitespace-nowrap pr-2"}," Os meus tickets "),e("span",{class:"text-white text-l xl:text-lg whitespace-nowrap justify-center bg-purple aspect-[1.5] px-2.5 rounded-3xl"},"10")],-1),_e=[he],fe={class:"justify-center flex flex-col pt-2"},me=e("div",{class:"text-purple text-l xl:text-lg whitespace-nowrap"}," Pending ",-1),ge=e("span",{class:"text-white text-l xl:text-lg whitespace-nowrap justify-center bg-purple aspect-[1.5] px-2.5 rounded-3xl"},"10",-1),be=[me,ge],ve=e("div",{class:"text-purple text-l xl:text-lg"}," Unassigned",-1),we=e("span",{class:"text-white text-l xl:text-lg whitespace-nowrap justify-center bg-purple aspect-[1.5] px-2.5 rounded-3xl"},"10",-1),ye=[ve,we],ke=e("div",{class:"text-purple text-l xl:text-lg whitespace-nowrap"}," Assigned ",-1),$e=e("span",{class:"text-white text-l xl:text-lg whitespace-nowrap justify-center bg-purple aspect-[1.5] px-2.5 rounded-3xl"},"10",-1),Ce=[ke,$e],Te=e("div",{class:"text-purple text-l xl:text-lg whitespace-nowrap"}," In Progress ",-1),je=e("span",{class:"text-white text-l xl:text-lg whitespace-nowrap justify-center bg-purple aspect-[1.5] px-2.5 rounded-3xl"},"10",-1),Se=[Te,je],Ae=e("div",{class:"text-purple text-l xl:text-lg whitespace-nowrap"}," Completed ",-1),Oe=e("span",{class:"text-white text-l xl:text-lg whitespace-nowrap justify-center bg-purple aspect-[1.5] px-2.5 rounded-3xl"},"10",-1),Me=[Ae,Oe],Ie=e("div",{class:"text-purple text-l xl:text-lg whitespace-nowrap"}," Solved ",-1),Ne=e("span",{class:"text-white text-l xl:text-lg whitespace-nowrap justify-center bg-purple aspect-[1.5] px-2.5 rounded-3xl"},"10",-1),De=[Ie,Ne],Ge={__name:"SideFilter",emits:["update:status","update:creator","update:assignee"],setup(o,{emit:m}){const u=m,n=_=>{u("update:status",_)},t=_=>{u("update:creator",_)},i=_=>{u("update:assignee",_)};return(_,a)=>(c(),I(Y,null,{default:$(()=>[v(H,null,{default:$(()=>[j("Tickets")]),_:1}),e("div",pe,[e("div",ue,[e("span",{onClick:a[0]||(a[0]=f=>(n("All"),t("All"),i("All"))),class:"hoverGreyDark rounded-t-lg text-pink-600 text-l xl:text-lg justify-center py-3.5 px-2 border-b-purple border-b-opacity-30 border-b border-solid"}," Todos os tickets "),xe,e("div",{onClick:a[1]||(a[1]=f=>t("Me")),class:"hoverGreyDark rounded-t-lg justify-center py-3.5 px-2 flex flex-col border-b-purple border-b-opacity-30 border-b border-solid"},_e),e("div",fe,[e("span",{onClick:a[2]||(a[2]=f=>(n("Pending"),t("All"),i("All"))),class:"justify-between flex py-3 px-2 hoverGreyDark rounded-lg"},be),e("span",{onClick:a[3]||(a[3]=f=>(n("Unassigned"),t("All"),i("All"))),class:"justify-between flex py-3 px-2 hoverGreyDark rounded-lg"},ye),e("span",{onClick:a[4]||(a[4]=f=>(n("Assigned"),t("All"),i("All"))),class:"justify-between flex py-3 px-2 hoverGreyDark rounded-lg"},Ce),e("span",{onClick:a[5]||(a[5]=f=>(n("In Progress"),t("All"),i("All"))),class:"justify-between flex py-3 px-2 hoverGreyDark rounded-lg"},Se),e("span",{onClick:a[6]||(a[6]=f=>(n("Completed"),t("All"),i("All"))),class:"justify-between flex py-3 px-2 hoverGreyDark rounded-lg"},Me),e("span",{onClick:a[7]||(a[7]=f=>(n("Solved"),t("All"),i("All"))),class:"justify-between flex py-3 px-2 hoverGreyDark rounded-lg"},De)])])])]),_:1}))}},Ue="data:image/svg+xml,%3c!DOCTYPE%20svg%20PUBLIC%20'-//W3C//DTD%20SVG%201.1//EN'%20'http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd'%3e%3c!--%20Uploaded%20to:%20SVG%20Repo,%20www.svgrepo.com,%20Transformed%20by:%20SVG%20Repo%20Mixer%20Tools%20--%3e%3csvg%20width='20'%20height='20'%20viewBox='0%200%2020%2020'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cg%20id='SVGRepo_bgCarrier'%20stroke-width='0'/%3e%3cg%20id='SVGRepo_tracerCarrier'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3cg%20id='SVGRepo_iconCarrier'%3e%3cpath%20d='M4%2012H20M12%204V20'%20stroke='%23fff'%20stroke-width='2'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3c/g%3e%3c/svg%3e",Ve={class:"text-purple flex sm:text-2xl text-xl whitespace-nowrap justify-between p-4 h-[9vh] border-b-purple border-b-opacity-30 border-b border-solid items-start"},Ee=e("div",null,"Todos os Tickets",-1),Pe={class:"flex flex-row justify-between p-3 border-b-black border-b-opacity-30 border-b border-solid items-start"},Le={class:"flex flex-col sm:flex-row items-center gap-2"},Re={class:"relative"},Be=e("img",{loading:"lazy",src:Ue,class:"self-center"},null,-1),ze=e("div",{class:"text-white sm:text-lg"},"Filtros",-1),Fe=[Be,ze],qe={key:0,class:"absolute left-0 mt-2 w-48 rounded-md shadow-lg bg-white ring-1 ring-black ring-opacity-5"},He={class:"py-1",role:"menu","aria-orientation":"vertical","aria-labelledby":"options-menu"},Ye=["href","onClick"],Qe=["onClick"],We={class:"flex gap-1"},Je=["onClick"],Ke=e("img",{loading:"lazy",src:re},null,-1),Xe={key:0,class:"absolute left-0 mt-2 w-48 rounded-md shadow-lg bg-white ring-1 ring-black ring-opacity-5 p-2"},Ze=["onUpdate:modelValue"],et=["value"],tt=["onClick"],st=["onClick"],lt={__name:"TopMenu",props:{searchTerm:String},emits:["update:searchTerm"],setup(o,{emit:m}){const u=o,n=m,t=W({isOpen:!1,selectedOptions:[],dropdownItems:[{id:1,name:"Estado",href:"#"},{id:2,name:"Categoria",href:"#"}]}),i=()=>{t.isOpen=!t.isOpen},_=r=>{t.selectedOptions.find(x=>x.id===r.id)||t.selectedOptions.push({...r,isOpen:!1,selectedNestedOptions:[],dropdownItems:[{id:1,name:"Nested 1",href:"#"},{id:2,name:"Nested 2",href:"#"}]}),t.isOpen=!1},a=r=>{r.selectedNestedOptions.find(x=>x.id===r.selectedNestedOption.id)||r.selectedNestedOptions.push(r.selectedNestedOption),r.selectedNestedOption=null,r.isOpen=!1},f=(r,x)=>{r.selectedNestedOptions=r.selectedNestedOptions.filter(l=>l.id!==x.id)};return(r,x)=>(c(),d(y,null,[e("span",Ve,[Ee,v(S(J),{to:"/tickets/create"},{default:$(()=>[v(ie,null,{default:$(()=>[j(" + Criar Ticket ")]),_:1})]),_:1})]),e("div",Pe,[e("div",Le,[e("div",Re,[e("button",{onClick:i,class:"justify-center bg-purple flex gap-2.5 px-5 sm:px-6 py-[5.5px] rounded-xl"},Fe),t.isOpen?(c(),d("div",qe,[e("div",He,[(c(!0),d(y,null,k(t.dropdownItems,l=>(c(),d("a",{key:l.id,href:l.href,onClick:K(p=>_(l),["prevent"]),class:"block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 hover:text-gray-900",role:"menuitem"},g(l.name),9,Ye))),128))])])):O("",!0)]),(c(!0),d(y,null,k(t.selectedOptions,l=>(c(),d("div",{key:l.id,class:"relative bg-purple text-white px-2 py-1 rounded-xl"},[e("button",{onClick:p=>l.isOpen=!l.isOpen},[e("div",We,[e("img",{loading:"lazy",src:oe,class:"self-center hoverRed rounded-md",onClick:p=>t.selectedOptions=t.selectedOptions.filter(C=>C.id!==l.id)},null,8,Je),e("p",null,g(l.name),1),Ke])],8,Qe),l.isOpen?(c(),d("div",Xe,[X(e("select",{"onUpdate:modelValue":p=>l.selectedNestedOption=p,class:"block w-full px-4 py-2 text-sm text-gray-700 bg-white border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm mb-2"},[(c(!0),d(y,null,k(l.dropdownItems,p=>(c(),d("option",{key:p.id,value:p},g(p.name),9,et))),128))],8,Ze),[[Z,l.selectedNestedOption]]),e("button",{class:"w-full text-center py-2 bg-purple text-white",onClick:p=>a(l)},"Done",8,tt)])):O("",!0),(c(!0),d(y,null,k(l.selectedNestedOptions,p=>(c(),d("div",{onClick:C=>f(l,p),key:p.id,class:"inline-block bg-white rounded-lg px-3 py-1 text-sm font-semibold text-purpleLight ml-1 hoverRed"},g(p.name),9,st))),128))]))),128))]),v(ce,{searchTerm:u.searchTerm,"onUpdate:searchTerm":x[0]||(x[0]=l=>n("update:searchTerm",l))},null,8,["searchTerm"])])],64))}},ot=o=>(D("data-v-d1479e20"),o=o(),G(),o),nt={class:"border-b-black border-b-opacity-30 border-b border-solid hoverGrey"},at={class:"hidden sm:flex pl-5"},rt={class:"flex gap-2.5 min-w-fit"},it=ot(()=>e("img",{loading:"lazy",src:ae,class:"aspect-square object-cover object-center w-12 overflow-hidden shrink-0 max-w-full rounded-[50%]"},null,-1)),ct={class:"flex flex-col h-full justify-center"},dt={class:"hidden sm:block text-black text-opacity-80 text-sm sm:text-lg"},pt={class:"hidden lg:block text-black text-opacity-50 text-sm sm:text-lg whitespace-nowrap"},ut={class:"text-black text-opacity-80 text-sm sm:text-lg"},xt={class:"flex justify-center sm:justify-start"},ht={class:"text-black text-opacity-80 text-sm sm:text-lg"},_t={class:"flex justify-center sm:justify-start sm:w-40"},ft={class:"text-white text-xs sm:text-lg"},mt={class:"flex justify-center sm:block"},gt={class:"bg-red-600 py-2 px-4 rounded-3xl w-fit"},bt={__name:"TicketItem",props:{ticket:Object,technicians:Array},setup(o){const m=U(),u=(n,t,i)=>{m.handleShowModal(n,t,i)};return(n,t)=>(c(),d("tr",nt,[e("td",at,[e("div",rt,[it,e("div",ct,[e("div",dt,g(o.ticket.createdby.name),1),e("div",pt,g(o.ticket.createdby.email),1)])])]),e("td",ut,[e("div",xt,g(o.ticket.title),1)]),e("td",ht,[e("div",_t,[v(ne,{assignedto:o.ticket.assignedto,technicians:o.technicians,onShowModal:u},null,8,["assignedto","technicians"])])]),e("td",ft,[e("div",mt,[e("div",gt,g(o.ticket.status.status_name),1)])])]))}},vt=N(bt,[["__scopeId","data-v-d1479e20"]]),wt=o=>(D("data-v-33fd418d"),o=o(),G(),o),yt={class:"table-auto"},kt=wt(()=>e("thead",null,[e("tr",{class:"border-b-black border-b-opacity-30 border-b border-solid"},[e("th",{class:"hidden sm:flex pl-5"},"REQUESTER"),e("th",null,"TITLE"),e("th",null,"ASSIGNEE"),e("th",null,"STATUS")])],-1)),$t={__name:"TicketsTable",props:{tickets:Array,technicians:Array},setup(o){const m=u=>{ee.push({name:"ticketDetails",params:{ticketId:u}})};return(u,n)=>(c(),d("table",yt,[kt,e("tbody",null,[(c(!0),d(y,null,k(o.tickets,t=>(c(),I(vt,{onClick:i=>m(t.id),key:t.id,ticket:t,technicians:o.technicians},null,8,["onClick","ticket","technicians"]))),128))])]))}},Ct=N($t,[["__scopeId","data-v-33fd418d"]]),Tt={class:"flex w-full"},jt={class:"flex flex-col w-full lg:w-[80%]"},St={class:"flex justify-between px-5 py-2 border-b-black border-b-opacity-30 border-b border-solid"},At={class:"text-black text-opacity-60 sm:text-xl"},Ot={class:"flex sm:gap-2.5"},Mt=["onClick"],Lt={__name:"ShowTicketPage",setup(o){const m=b([]),u=b([]),n=b(1),t=b(5),i=b(""),_=b("All"),a=b("All"),f=b("All");let r=b(null);const x=U();te(async()=>{try{m.value=(await Q.getTickets()).data,r.value=await A.getAuthedUser()}catch(s){console.error("Erro ao procurar tickets:",s)}await B()});const l=()=>{x.handleCancelModal()},p=()=>{x.handleConfirmModal()},C=M(()=>{let s=m.value.filter(h=>{const z=h.title?h.title.toLowerCase():"",F=h.createdby?h.createdby.name.toLowerCase():"",q=h.assignedto?h.assignedto.name.toLowerCase():"";return z.includes(i.value.toLowerCase())||F.includes(i.value.toLowerCase())||q.includes(i.value.toLowerCase())});_.value!=="All"&&(s=s.filter(h=>h.status.status_name===_.value)),a.value==="Me"&&r.value&&r.value.success&&(s=s.filter(h=>h.createdby.id===r.value.user.id)),f.value==="Me"&&r.value&&r.value.success&&(s=s.filter(h=>h.assignedto.id===r.value.user.id));const T=(n.value-1)*t.value,w=T+t.value;return s.slice(T,w)}),V=M(()=>Math.ceil(C.value.length/t.value)),E=s=>{n.value=s};se(i,()=>{n.value=1});const P=s=>{_.value=s,n.value=1},L=s=>{a.value=s==="Me"?"Me":"All",n.value=1},R=s=>{f.value=s==="Me"?"Me":"All",n.value=1},B=async()=>{try{const s=await A.getTechnicians();s.success?u.value=s.data:console.error("Invalid response structure:",s)}catch(s){console.error("Error fetching technicians:",s)}};return(s,T)=>(c(),d("div",Tt,[v(Ge,{"onUpdate:status":P,"onUpdate:creator":L,"onUpdate:assignee":R}),e("span",jt,[v(lt,{searchTerm:i.value,"onUpdate:searchTerm":T[0]||(T[0]=w=>i.value=w)},null,8,["searchTerm"]),e("span",St,[e("div",At,g(m.value.length)+" Tickets",1),e("div",Ot,[(c(!0),d(y,null,k(V.value,w=>(c(),d("span",{class:le(["text-black sm:text-xl justify-center px-1.5 py-0.5 rounded-md self-start cursor-pointer",{"bg-purple text-white":w===n.value,"aspect-[0.8148148148148148]":!0}]),key:w,onClick:h=>E(w)},g(w),11,Mt))),128))])]),v(Ct,{tickets:C.value,technicians:u.value},null,8,["tickets","technicians"]),v(de,{show:S(x).showModal,onCancel:l,onConfirm:p},{title:$(()=>[j(" Assign Technician ")]),content:$(()=>[j(" You are about to assign "+g(S(x).selectedTechnician)+" to this ticket, are you sure? ",1)]),_:1},8,["show"])])]))}};export{Lt as default};
