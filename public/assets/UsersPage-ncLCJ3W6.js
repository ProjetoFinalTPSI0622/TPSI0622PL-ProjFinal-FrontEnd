import{e as r,f as i,g as e,l as _,w as $,m as y,u as D,R as I,F as A,r as w,t as v,k as T,_ as L,i as P,j as E,D as N,B,C as O,h as k,Y as j,E as C,o as R,x as V,p as F,z as G,y as K}from"./index-pqQ-StaB.js";import{U as z}from"./UserService-Md1eL1dT.js";import{S as Z}from"./SimpleButton-yUcAyILW.js";import{_ as q,u as H}from"./Modal-Yuxk1HSr.js";const Y={class:"border bg-white flex justify-between w-40 lg:w-60 py-1 lg:py-0 lg:px-2.5 rounded-xl border-solid border-black border-opacity-20"},J=e("img",{loading:"lazy",src:"https://cdn.builder.io/api/v1/image/assets/TEMP/d8924cf9b87a9ac8c714bc39eb9f2f1e4dbacd969a523930ca05221671cf2023?apiKey=a9b902b8934746c7aacbbad131e88c89&",class:"aspect-[1.5] object-contain object-center"},null,-1),Q=["value"],W={__name:"UsersSearchBox",props:{searchTerm:String},setup(s){return(o,t)=>(r(),i("span",Y,[J,e("input",{type:"text",class:"bg-transparent text-gray-900 focus:outline-none focus-visible:outline-none rounded-lg w-full lg:p-2.5",placeholder:"Search all... ",value:s.searchTerm,onInput:t[0]||(t[0]=a=>o.$emit("update:searchTerm",a.target.value))},null,40,Q)]))}},X={class:"text-purple flex sm:text-2xl text-xl whitespace-nowrap justify-between p-4 border-b-purple border-b-opacity-30 border-b border-solid items-start"},ee=e("div",null,"All Users",-1),te={class:"flex flex-row justify-between p-3 border-b-black border-b-opacity-30 border-b border-solid items-start"},se=e("span",{class:"justify-center bg-purple flex gap-2.5 px-3 sm:px-6 py-[5.5px] rounded-xl"},[e("div",{class:"text-white sm:text-xl"},"Filter"),e("img",{loading:"lazy",src:"https://cdn.builder.io/api/v1/image/assets/TEMP/0510fad93eca8f0eb44f11602487e1815b688bf1e81320ed0afe33b8cdcc0f34?apiKey=a9b902b8934746c7aacbbad131e88c89&",class:"w-6 sm:aspect-[1.04] object-contain object-center"})],-1),oe={class:""},ae={__name:"TopMenu",props:{searchTerm:String},emits:["update:searchTerm"],setup(s,{emit:o}){const t=s,a=o;return(l,d)=>(r(),i(A,null,[e("span",X,[ee,_(D(I),{to:"/users/create"},{default:$(()=>[_(Z,null,{default:$(()=>[y(" + Add User ")]),_:1})]),_:1})]),e("div",te,[se,e("div",oe,[_(W,{searchTerm:t.searchTerm,"onUpdate:searchTerm":d[0]||(d[0]=p=>a("update:searchTerm",p))},null,8,["searchTerm"])])])],64))}},le={class:"hoverGrey border-b-black border-b-opacity-30 border-b border-solid grid grid-cols-3 sm:grid-cols-4 gap-4 pl-[10%] pr-[5%] sm:pl-[20%] sm:pr-[15%]"},re={class:"flex flex-col gap-1 py-2 overflow-hidden overflow-ellipsis"},ne=["src"],ie={class:"flex w-full"},ce={class:"whitespace-nowrap text-black text-opacity-80 text-xs sm:text-lg text-left sm:w-full overflow-hidden overflow-ellipsis"},de={class:"hidden sm:block whitespace-nowrap text-xs sm:text-lg self-center overflow-hidden overflow-ellipsis"},ue={class:"hidden sm:block whitespace-nowrap text-xs sm:text-lg self-center overflow-hidden overflow-ellipsis"},pe={class:"whitespace-nowrap py-2.5 sm-py-0 self-center"},he={class:"flex"},me={class:"font-bold"},fe=e("br",null,null,-1),be=e("p",{class:"font-bold text-red-600"},"ATENÇÃO!!!",-1),_e=e("p",{class:"text-red-600"},"Esta acção não pode ser revertida!",-1),ve={__name:"UserItem",props:{user:Object},emits:["userDeleted"],setup(s,{emit:o}){const t=o,a=w(!1),l=w(null),d=h=>{l.value=h,a.value=!0},p=async()=>{if(event.stopPropagation(),l.value){const h=await z.deleteUser(l.value.id);h.success?(H().triggerToast(`Utilizador ${l.value.name}, apagado com sucesso!`,"success"),t("userDeleted")):console.error("Error deleting user:",h.message)}a.value=!1},b=()=>{a.value=!1,event.stopPropagation()};return(h,m)=>(r(),i("tr",le,[e("td",re,[e("img",{loading:"lazy",src:s.user.user_info.profile_picture_path,class:"aspect-square object-cover content-start w-12 overflow-hidden shrink-0 max-w-full rounded-[50%]"},null,8,ne),e("div",ie,[e("div",ce,v(s.user.name),1)])]),e("td",de,v(s.user.user_info.class),1),e("td",ue,v(s.user.internalcode),1),e("td",pe,[e("button",{onClick:m[0]||(m[0]=T(u=>d(s.user),["stop"])),class:"px-4 py-2 mr-2 bg-red-500 text-white rounded hover:bg-red-700 transition duration-300 text-xs sm:text-lg"}," Apagar "),e("button",{onClick:m[1]||(m[1]=T(u=>d(s.user),["stop"])),class:"px-4 py-2 bg-yellow-600 text-white rounded hover:bg-red-700 transition duration-300 text-xs sm:text-lg"}," Reset Password ")]),_(q,{show:a.value,onCancel:b,onConfirm:p},{title:$(()=>[y(" Apagar utilizador ")]),content:$(()=>[e("p",he,[y("Esta prestes a apagar  "),e("div",me,v(s.user.name),1),y(", pretende prosseguir?")]),fe,be,_e]),_:1},8,["show"])]))}},ge=s=>(B("data-v-1159479b"),s=s(),O(),s),xe={class:"table-auto"},we=ge(()=>e("thead",null,[e("tr",{class:"grid grid-cols-3 sm:grid-cols-4 pl-[10%] pr-[5%] sm:pl-[20%] sm:pr-[15%] border-b-black border-b-opacity-30 border-b border-solid"},[e("th",{class:"w-1/4 self-center"},"NOME"),e("th",{class:"w-1/4 self-center"},"TURMA"),e("th",{class:"hidden sm:block w-1/4 self-center"},"CÓDIGO INTERNO"),e("th",{class:"w-1/4 self-center"},"ACÇÕES")])],-1)),ye={class:"max-h-[55vh] sm:max-h-[59vh] overflow-y-auto"},$e={__name:"UsersTable",props:{users:Array},emits:["userDeleted"],setup(s,{emit:o}){const t=o,a=d=>{N.push({name:"userDetails",params:{userId:d}})},l=()=>{t("userDeleted")};return(d,p)=>(r(),i("table",xe,[we,e("div",ye,[e("tbody",null,[(r(!0),i(A,null,P(s.users,b=>(r(),E(ve,{onClick:T(h=>a(b.id),["stop"]),key:b.id,user:b,onUserDeleted:l},null,8,["onClick","user"]))),128))])])]))}},ke=L($e,[["__scopeId","data-v-1159479b"]]),Ce={name:"ChevronRightCircleOutlineIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}},Te=["aria-hidden","aria-label"],Ae=["fill","width","height"],Le={d:"M22,12A10,10 0 0,1 12,22A10,10 0 0,1 2,12A10,10 0 0,1 12,2A10,10 0 0,1 22,12M20,12A8,8 0 0,0 12,4A8,8 0 0,0 4,12A8,8 0 0,0 12,20A8,8 0 0,0 20,12M8.6,16.6L13.2,12L8.6,7.4L10,6L16,12L10,18L8.6,16.6Z"},Me={key:0};function Ue(s,o,t,a,l,d){return r(),i("span",j(s.$attrs,{"aria-hidden":t.title?null:!0,"aria-label":t.title,class:"material-design-icon chevron-right-circle-outline-icon",role:"img",onClick:o[0]||(o[0]=p=>s.$emit("click",p))}),[(r(),i("svg",{fill:t.fillColor,class:"material-design-icon__svg",width:t.size,height:t.size,viewBox:"0 0 24 24"},[e("path",Le,[t.title?(r(),i("title",Me,v(t.title),1)):k("",!0)])],8,Ae))],16,Te)}const Se=L(Ce,[["render",Ue]]),Pe={name:"ChevronLeftCircleOutlineIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}},je=["aria-hidden","aria-label"],ze=["fill","width","height"],De={d:"M22,12A10,10 0 0,1 12,22A10,10 0 0,1 2,12A10,10 0 0,1 12,2A10,10 0 0,1 22,12M20,12A8,8 0 0,0 12,4A8,8 0 0,0 4,12A8,8 0 0,0 12,20A8,8 0 0,0 20,12M15.4,16.6L10.8,12L15.4,7.4L14,6L8,12L14,18L15.4,16.6Z"},Ie={key:0};function Ee(s,o,t,a,l,d){return r(),i("span",j(s.$attrs,{"aria-hidden":t.title?null:!0,"aria-label":t.title,class:"material-design-icon chevron-left-circle-outline-icon",role:"img",onClick:o[0]||(o[0]=p=>s.$emit("click",p))}),[(r(),i("svg",{fill:t.fillColor,class:"material-design-icon__svg",width:t.size,height:t.size,viewBox:"0 0 24 24"},[e("path",De,[t.title?(r(),i("title",Ie,v(t.title),1)):k("",!0)])],8,ze))],16,je)}const Ne=L(Pe,[["render",Ee]]),Be={class:"flex w-full"},Oe={class:"flex flex-col w-full"},Re={class:"flex justify-between px-5 py-2 border-b-black border-b-opacity-30 border-b border-solid"},Ve={class:"text-black text-opacity-60 sm:text-xl"},Fe={class:"flex gap-1 sm:gap-2.5"},Ge=e("option",{value:"5"},"5 por pagina",-1),Ke=e("option",{value:"10"},"10 por pagina",-1),Ze=e("option",{value:"20"},"20 por pagina",-1),qe=["value"],He=["onClick"],Xe={__name:"UsersPage",setup(s){const o=w([]),t=w(1),a=w(5),l=w(""),d=C(()=>{let u=[];const n=h.value,c=t.value;let f=Math.max(c-2,1),g=f+4;g>n&&(g=n,f=Math.max(1,g-4));for(let x=f;x<=g;x++)u.push(x);return u}),p=C(()=>{const u=o.value.filter(f=>{var g,x,M,U,S;return((g=f.name)==null?void 0:g.toLowerCase().includes(l.value.toLowerCase()))||((x=f.email)==null?void 0:x.toLowerCase().includes(l.value.toLowerCase()))||((M=f.internalcode)==null?void 0:M.toLowerCase().includes(l.value.toLowerCase()))||((S=(U=f.user_info)==null?void 0:U.class)==null?void 0:S.toLowerCase().includes(l.value.toLowerCase()))}),n=(t.value-1)*a.value,c=n+a.value;return u.slice(n,c)}),b=async()=>{try{o.value=(await z.getUsers()).data}catch(u){console.error("Erro ao procurar usuários:",u)}};R(async()=>{await b()});const h=C(()=>Math.ceil(o.value.length/a.value)),m=u=>{t.value=Math.max(1,Math.min(u,h.value))};return V(l,()=>{t.value=1}),(u,n)=>(r(),i("div",Be,[e("span",Oe,[_(ae,{searchTerm:l.value,"onUpdate:searchTerm":n[0]||(n[0]=c=>l.value=c)},null,8,["searchTerm"]),e("span",Re,[e("div",Ve,v(o.value.length)+" Users",1),e("div",Fe,[F(e("select",{"onUpdate:modelValue":n[1]||(n[1]=c=>a.value=c),onChange:n[2]||(n[2]=c=>m(1))},[Ge,Ke,Ze,e("option",{value:o.value.length},"All",8,qe)],544),[[G,a.value]]),t.value>1?(r(),i("button",{key:0,onClick:n[3]||(n[3]=c=>m(t.value-1)),class:"text-black sm:text-xl justify-center px-1.5 py-0.5 rounded-md self-start cursor-pointer"},[_(Ne)])):k("",!0),(r(!0),i(A,null,P(d.value,c=>(r(),i("span",{class:K(["text-black sm:text-xl justify-center px-1.5 py-0.5 rounded-md self-start cursor-pointer",{"bg-purple text-white":c===t.value,"aspect-[0.8148148148148148]":!0}]),key:c,onClick:f=>m(c)},v(c),11,He))),128)),t.value<h.value?(r(),i("button",{key:1,onClick:n[4]||(n[4]=c=>m(t.value+1)),class:"text-black sm:text-xl justify-center px-1.5 py-0.5 rounded-md self-start cursor-pointer"},[_(Se)])):k("",!0)])]),_(ke,{users:p.value,onUserDeleted:b},null,8,["users"])])]))}};export{Xe as default};
